<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  </head>
  <body>
    <h1>Hello, world!</h1>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <div class="row">
	  <div class="span4">Read This</div>
	  <div class="span8">Code</div>
	</div>
	<div class="row">
	  <div class="span4">
	  	<p>
	  		Some documneation in here followed by lines of code next to it
	  	</p>	
	  </div>
	  <div class="span8">
	  	<p>
	  		package scenarios;

import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.Wait;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Assert;
import org.testng.annotations.Test;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.List;


public class Chapter_01_temp_TheFirstSeleniumTest {

	
	// Change the driver as per your preferred browser
	WebDriver driver = new FirefoxDriver();

	@Test
	public void testThatResultsAppearForAOneWayJourney(){
		
		driver.get("http://www.cleartrip.com/");
		driver.findElement(By.id("one_way")).click();
		
		driver.findElement(By.id("origin_autocomplete")).clear();
		driver.findElement(By.id("origin_autocomplete")).sendKeys("Bangalore");
		
		//wait for the auto complete options to appear for the origin

        waitFor(2000);
        List<WebElement> originOptions = driver.findElement(By.id("autocompleteOptionsContainer")).findElements(By.tagName("li"));
		originOptions.get(0).click();
		
		driver.findElement(By.id("destination_autocomplete")).clear();
		driver.findElement(By.id("destination_autocomplete")).sendKeys("Delhi");
		
		//wait for the auto complete options to appear for the destination

        waitFor(2000);
        //select the first item from the destination auto complete list
		List<WebElement> destinationOptions = driver.findElement(By.id("autocompleteOptionsContainer")).findElements(By.tagName("li"));
		destinationOptions.get(0).click();
		
		driver.findElement(By.id("dpt_date")).clear();
		driver.findElement(By.id("dpt_date")).sendKeys(tomorrow());
		
		//all fields filled in. Now click on search
		driver.findElement(By.id("button_flight_search")).click();

        waitFor(5000);
		//verify that result appears for the provided journey search
	    Assert.assertTrue(isElementPresent(By.id("outbound")));
		
		//close the browser
		driver.close();
		
	}

    private void waitFor(int durationInMilliSeconds) {
        try {
            Thread.sleep(durationInMilliSeconds);
        } catch (InterruptedException e) {
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }
    }


    public void waitForSearchResultsToAppear() {
        Wait<WebDriver> wait = new WebDriverWait(driver, 30);
        wait.until(visibilityOfElementLocated(By.id("mod_link")));
    }

    public ExpectedCondition<WebElement> visibilityOfElementLocated(final By locator) {
        return new ExpectedCondition<WebElement>() {
            public WebElement apply(WebDriver driver) {
                WebElement toReturn = driver.findElement(locator);
                if (toReturn.isDisplayed()) {
                    return toReturn;
                }
                return null;
            }
        };
    }

	private boolean isElementPresent(By by) {
		try {
			driver.findElement(by);
			return true;
		} catch (NoSuchElementException e) {
			return false;
		}
	}

	public String tomorrow(){
		Calendar c = Calendar.getInstance();  
		c.add(Calendar.DATE, 1);  
		return new SimpleDateFormat("dd/MM/yyyy").format(c.getTime());  
	}
}

	  	</p>	
	  </div>
	</div>
  </body>
</html>
